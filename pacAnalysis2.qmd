---
title: "PAC Analysis"
format: html
editor: visual
---

```{r include=FALSE}

knitr::opts_chunk$set(echo = FALSE)

library(tidyverse)
library(ggthemes) 
library(gganimate)
library(gifski)
```

```{r}
# 
# updatedpacdf <- processpac %>%
#   summarise(dems_sum = sum(Dems), 
#             repubs_sum = sum(Repubs),
#             total_sum = sum(Total), .by = c(Country, year)) %>%
#   ungroup() |>
#   arrange(Country) |>
#   mutate(country = Country, year_cycle = year) |>
#   select(country, dems_sum, repubs_sum, total_sum, year_cycle)
# 
# write_csv(updatedpacdf, 'combined_pac2.csv')
```



## Introduction

This project aims to examine the impact of foreign-connected Political Action Committee (PAC) donations on US politics from 2000 to 2024. Specifically, it will analyze the possible correlation between the contributions made by PACs affiliated with foreign companies or entities to Democratic and Republican seats in Congress to the presidential election results. The ultimate goal is to determine whether there is a relationship between Foreign PAC Donations and US political results, and if so, to understand the extent to which such donations influence political outcomes and partisan dynamics in the United States.


## Data Methodology

### OpenSecrets

For OpenSecrets Dataset (Raw: 2636 Rows; No NAs; Predictors: PAC Donation amount):


```{r}
pacdf1 <- read_csv("pacdf/pacdf1999-2000.csv", show_col_types = FALSE) |>
  mutate(year = 2000)

pacdf2 <- read_csv("pacdf/pacdf2001-2002.csv",  show_col_types = FALSE) |>
  mutate(year = 2002)

pacdf3 <- read_csv("pacdf/pacdf2003-2004.csv", show_col_types = FALSE) |>
  mutate(year = 2004)

pacdf4 <- read_csv("pacdf/pacdf2005-2006.csv", show_col_types = FALSE) |>
  mutate(year = 2006)

pacdf5 <- read_csv("pacdf/pacdf2007-2008.csv", show_col_types = FALSE) |>
  mutate(year = 2008)

pacdf6 <- read_csv("pacdf/pacdf2009-2010.csv", show_col_types = FALSE) |>
  mutate(year = 2010)

pacdf7 <- read_csv("pacdf/pacdf2011-2012.csv", show_col_types = FALSE) |>
  mutate(year = 2012)

pacdf8 <- read_csv("pacdf/pacdf2013-2014.csv", show_col_types = FALSE) |>
  mutate(year = 2014)

pacdf9 <- read_csv("pacdf/pacdf2015-2016.csv", show_col_types = FALSE) |>
  mutate(year = 2016)

pacdf10 <- read_csv("pacdf/pacdf2017-2018.csv", show_col_types = FALSE) |>
  mutate(year = 2018)

pacdf11 <- read_csv("pacdf/pacdf2019-2020.csv", show_col_types = FALSE) |>
  mutate(year = 2020)

pacdf12 <- read_csv("pacdf/pacdf2021-2022.csv", show_col_types = FALSE) |>
  mutate(year = 2022)

pacdf13 <- read_csv("pacdf/pacdf2023-2024.csv", show_col_types = FALSE) |>
  mutate(year = 2024)


combinepacdf <- bind_rows(pacdf1, pacdf2, pacdf3, pacdf4, pacdf5, 
          pacdf6, pacdf7, pacdf8, pacdf9, pacdf10, 
          pacdf11, pacdf12, pacdf13)

combinepacdf
```
- The dataset includes information on PAC donations from foreign-connected entities to US political parties from 2000 to 2024 (Initially in two-year intervals but was later combined).

- It consists of columns such as PAC Name (Affiliate), Country of Origin/Parent Company, Total donation amount, and amounts donated to Democratic and Republican parties.
Each row represents a different PAC donation entry, detailing the contribution amounts and affiliations.

- Data types in the dataset include strings for PAC names and countries of origin and integers or floats for donation amounts.

After some data wrangling and processing, the ultiamte PAC dataset that will be analyze upon looks like following: 

```{r}
processpac_data = read_csv("combined_pac2.csv", show_col_types = FALSE)

processpac_data
```


### Congressional Distribution by Parties

For Wikipedia Dataset (Raw: 118 Rows; No NAs; Target Variable: Seats by Parties):

![Wikipedia Screenshot](wikishot1.png) 

- The dataset provides a record of the party divisions within the United States Congress since 1789 through various congressional sessions.

- It includes columns such as Congress, Years, Senate composition (Total, Anti-Administration, Pro-Administration, Others, Vacancies), House of Representatives composition (Total, Anti-Administration, Pro-Administration, Others, Vacancies), President, and Trifecta status.
Each row corresponds to a specific congressional session, detailing the composition of the Senate and House of Representatives, any presidential affiliations, and whether a trifecta scenario was present.

- Data types in the dataset include integers for numerical values such as the total number of seats and vacancies, strings for textual information such as the President's name, and categorical variables for party affiliations.

Similarly, the ultiamte Congress Parties dataset that will be analyze upon looks like following: 
```{r}
processcongressdf = read_csv("house_senate.csv", show_col_types = FALSE) 
processcongressdf
```


```{r echo = FALSE, include = FALSE}
csv_data = read_csv("combined_pac2.csv")
anim_data = csv_data %>% mutate(president_party = case_when(
  (year_cycle >= 2000 & year_cycle < 2008) ~ "Republican",
  (year_cycle >= 2008 & year_cycle < 2016) ~ "Democrat",
  (year_cycle >= 2016 & year_cycle < 2020) ~ "Republican",
  (year_cycle >= 2020 & year_cycle <= 2024) ~ "Democrat"
))

house_senate_csv = csv_data %>%
  group_by(year_cycle) %>%
  summarize(dem_total = sum(dems_sum)/sum(total_sum),
            repub_total = sum(repubs_sum)/sum(total_sum), .groups="drop") %>% 
  pivot_longer(cols=c(dem_total, repub_total), names_to="position", values_to="value") %>% 
  mutate(branch="Donations") %>% 
  rename(year=year_cycle)

house_senate_csv_1 = read_csv("house_senate.csv") %>%
  mutate(democratic_senate=(democratic_senate_1/(democratic_senate_1 + republican_senate_1)),
         republican_senate=(republican_senate_1/(democratic_senate_1 + republican_senate_1)),
         democratic_house=(democratic_house_1/(democratic_house_1 + republican_house_1)),
         republican_house=(republican_house_1/(democratic_house_1 + republican_house_1))) %>% 
  select(-c(republican_house_1, democratic_house_1, republican_senate_1, democratic_senate_1)) %>% 
  pivot_longer(cols=c(democratic_senate, republican_senate, democratic_house, republican_house), names_to="position", values_to="value") %>% 
  mutate(branch=if_else(str_detect(position, "senate"), "Senate", "House"))

house_senate_bound = bind_rows(house_senate_csv, house_senate_csv_1) %>% 
  mutate(party=if_else(str_detect(position, "repub"),
                       "Republican", "Democrat")) 

REPhouse_donation_correlation = cor(house_senate_bound %>% filter(position == "repub_total") %>% pull(value), house_senate_bound %>% filter(position == "republican_house") %>% pull(value))

REPsenate_donation_correlation = cor(house_senate_bound %>% filter(position == "repub_total") %>% pull(value), house_senate_bound %>% filter(position == "republican_senate") %>% pull(value))

DEMhouse_donation_correlation = cor(house_senate_bound %>% filter(position == "dem_total") %>% pull(value), house_senate_bound %>% filter(position == "democratic_house") %>% pull(value))

DEMsenate_donation_correlation = cor(house_senate_bound %>% filter(position == "dem_total") %>% pull(value), house_senate_bound %>% filter(position == "democratic_senate") %>% pull(value))

```

## Data Wrangling


## Analysis

### Overview of PAC Influence on US Congress Representation
```{r house-senate-plot}

house_senate_anim <- house_senate_bound %>% 
  mutate(position=str_sub(position, 1, 2)) %>% ggplot(mapping=aes(x=position, y=value, fill=party)) + geom_col(position="dodge") +
  facet_wrap(~branch) +
  scale_fill_manual(values = c("blue", "red"), labels = c("Democrat", "Republican")) +
  scale_x_discrete(labels=c("Democrat", "Republican")) + 
  scale_y_continuous(labels=scales::percent_format(accuracy=1)) +
  theme_clean() +
  theme(axis.text.x = element_text(angle=-90, hjust=0)) +
  labs(title = "Distribution of PAC Donations and Congress Representation",
       subtitle = "Year {closest_state}, party in office: {anim_data %>% filter(year_cycle == closest_state) %>% slice(1) %>% pull(president_party)}",
       x = "Party",
       y = "Representation (%)",
       fill = "Party",
       caption = "OpenSecrets (2024)") + 
  transition_states(year, transition_length = 2, state_length = 1)

animate(house_senate_anim)
```

```{r line-plot}
ggplot(house_senate_bound, aes(x=year, y=value, color=party)) + geom_line(aes(linetype=branch)) + facet_wrap(~party) + theme_clean() + 
  theme(axis.text.x = element_text(angle=-60, hjust=0)) + 
  labs(title = "PAC Donations and Congress Representation Over Time",
       subtitle = "Trend of Donation seems to determine representation in congress", 
       x = "Year", 
       y = "Representation (%)", 
       color = "Party", 
       linetype = "Lines",
       caption = "OpenSecrets (2020)") + 
  scale_y_continuous(labels = scales::percent_format(accuracy=1)) + 
  scale_color_manual(values = c("blue", "red"))
```

Correlation Between House of Representative and Donation Percentages:
Republican: **`r sprintf("%.3f", REPhouse_donation_correlation)`**
Democratic: **`r sprintf("%.3f", DEMhouse_donation_correlation)`**

Correlation Between Senate and Donation Percentages:
Republican: **`r sprintf("%.3f", REPsenate_donation_correlation)`**
Democratic **`r sprintf("%.3f", DEMsenate_donation_correlation)`**

From the plots, it seems that the party representation in Congress almost parallels the trend of foreign-connected PAC donations.

In fact, looking closely, the trend of donations seem the predict the representation as the changes in donations happen earlier than the changes in representation.

Additionally, it seems that Republicans usually receive more PAC donations than Democrats, but the percentage of donations of the Democrats seem to be growing closer to that of Republicans in recent years.

### PAC by Countries/Regions

```{r echo = FALSE, include = FALSE}

csv_data_country = read_csv("combined_pac2.csv")
year_cycles = seq(2000, 2024, by=2)
country_list = list()
for (year in year_cycles){
  country_list = union(country_list, (csv_data_country %>% filter(year_cycle==year))$country)
}
for (cntry in country_list){
  
  for (year in year_cycles){
    if (!(cntry %in% (csv_data_country %>% filter(year_cycle==year))$country)){
      csv_data_country = csv_data_country %>% add_row(year_cycle=year,
                                      country=cntry,
                                      dems_sum=0.0,
                                      repubs_sum=0.0,
                                      total_sum=0.0)
    }
  }
}
anim_data_country <- csv_data_country %>% pivot_longer(cols=c(dems_sum, repubs_sum), names_to="party", values_to="amount") %>% mutate(president_party = case_when(
  (year_cycle >= 2000 & year_cycle < 2008) ~ "Republican",
  (year_cycle >= 2008 & year_cycle < 2016) ~ "Democrat",
  (year_cycle >= 2016 & year_cycle < 2020) ~ "Republican",
  (year_cycle >= 2020 & year_cycle <= 2024) ~ "Democrat"
))
```
```{r}
anim_country <- ggplot(data=anim_data_country, mapping=aes(x=country, y=amount/100000, fill=party)) +
  geom_col(position="dodge") +
  labs(title = "Country PAC Donations by Party",
       subtitle="Year {closest_state}, party in office: {anim_data_country %>% filter(year_cycle == closest_state) %>% slice(1) %>% pull(president_party)}",
       x = "Country",
       y = "Donation Amount (by $100,000)",
       fill = "Party",
       caption = "OpenSecrets (2020)") +
  transition_states(year_cycle, transition_length = 2, state_length = 1) +
  theme_classic() +
  theme(axis.text.x=element_text(angle = -90, hjust=0)) +
  scale_fill_manual(values=c("blue", "red"),
                    labels=c("Democrat", "Republican"))
animate(anim_country, nframes=200)
```

```{r}
house_senate_bound

```




